<h1><%= @event.title %></h1>
<p><strong>Description:</strong> <%= @event.description %></p>
<p><strong>Location:</strong> <%= @event.location %></p>
<p><strong>Date:</strong> <%= @event.date %></p>
<p><strong>Created by:</strong> <%= link_to @event.creator.email, user_path(@event.creator) %></p>

<hr>

<h3>Attendees</h3>

<% if @attendees.any? %>
  <ul>
    <% @attendees.each do |attendee| %>
      <li><%= link_to attendee.email, user_path(attendee) %></li>
    <% end %>
  </ul>
<% else %>
  <p>No attendees yet.</p>
<% end %>

<% unless @attendees.include?(current_user) %>
  <%= button_to "Attend Event", event_event_attendances_path(@event), method: :post %>
<% end %>

<% if current_user == @event.creator %>
  <h3>Invite Users</h3>
  <%= form_with url: event_invitations_path(@event), method: :post do |f| %>
    <%= collection_check_boxes(:event, :user_ids, User.all.where.not(id: current_user.id), :id, :email) %>
    <%= f.submit "Send Invitations" %>
  <% end %>
<% end %>

<% if current_user == @event.creator %>
  <%= link_to "Edit", edit_event_path(@event) %>
  <%= link_to "Delete", event_path(@event), data: { turbo_method: :delete } %>
<% end %>

<% if @event.attendees.include?(current_user) %>
  <%= button_to "Leave Event",
      event_attendance_path(
        @event.event_attendances.find_by(attendee: current_user)
      ),
      method: :delete %>
<% end %>